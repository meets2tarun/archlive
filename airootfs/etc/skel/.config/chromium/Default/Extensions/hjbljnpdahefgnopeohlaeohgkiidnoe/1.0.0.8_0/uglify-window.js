(function(){function e(){chrome.app.window.current().fullscreen()}$(document).ready(function(){if(window.waiter){window.waiter()}$("#fullscreen-img").click(e);common.attachDefaultListeners()});function o(){var e={filter:"original",filterHorLuma:"optimized",filterVerLumaEdge:"optimized",getBoundaryStrengthsA:"optimized"};var o;var t=new Avc;this.avc=t;t.configure(e,function(){console.log("callback for avc")});var n;t.onPictureDecoded=function(e,t,i){if(!e){console.log("no buffer?");return}if(!o){n=Date.now();console.log("first frame decoded");tracker.sendEvent("view-device");var r=$("#mirror");var a=r[0];o=new WebGLCanvas(a,undefined,{});if(!o.contextGL){var c=chrome.runtime.getManifest().name;chrome.notifications.create("enableWebGL",{type:"basic",iconUrl:"/icon.png",title:c,message:"WebGL is disabled in Chrome. Enable it for Vysor to work properly.",isClickable:true,buttons:[{title:"Enable WebGL"}]})}}else{var d=Date.now();var l=d-n;if(l>60*1e3){n=d;trackUsage(l)}}if(!rectWidth||!rectHeight)return;o.drawNextOutputPicture(t,i,{left:0,top:0,width:Math.round(rectWidth),height:Math.round(rectHeight)},e)};nextTick(function(){this.onReadyForData()}.bind(this))}o.prototype.decode=function(e){this.avc.decode(e);this.onReadyForData()};function t(e,o){$("#listener").empty();var t;var n;var i;if(window.isElectron&&isElectron()){t="host";n=null;i="application/x-ppapi-vysor"}else{t="pnacl";n="video_decode/pnacl/Release";i=null}common.createNaClModule("video_decode",i,t,n,e,o,{},function(e){if(e.data=="decoder-falling-behind"){if(this.onDecoderFallingBehind)this.onDecoderFallingBehind()}else if(e.data=="decoder-ready"){if(this.onReady)this.onReady();else console.error("no listener for decoder-ready")}}.bind(this),function(){console.log("NACL module initialized");common.naclModule.postMessage("software")}.bind(this))}t.prototype.decode=function(e,o,t){if(!common.naclModule||!common.naclModule.postMessage){console.error("decode called before initialization");return}common.naclModule.postMessage({buffer:e.buffer,byteOffset:e.byteOffset,byteLength:e.byteLength,presentationTimeMs:o,syncFrame:t})};window.PepperDecoder=t})();
